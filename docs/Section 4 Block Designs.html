<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Block Designs â€“ Stat 212 Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Section 5 Split Plot Designs.html" rel="next">
<link href="./Section 3 Factorial Treatment Design.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-77205cbbef6a5b90ba72edc25dea2156.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Section 4 Block Designs.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Designs</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Stat 212 Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Goals for STAT 212</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 1 Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 2 Completely Randomized Design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The Completely Randomized Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 3 Factorial Treatment Design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Factorial Treatment Designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 4 Block Designs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Designs</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Section 5 Split Plot Designs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Split-Plot Designs</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-randomized-complete-block-design" id="toc-the-randomized-complete-block-design" class="nav-link active" data-scroll-target="#the-randomized-complete-block-design"><span class="header-section-number">4.1</span> The Randomized Complete Block Design</a>
  <ul class="collapse">
  <li><a href="#selecting-blocks" id="toc-selecting-blocks" class="nav-link" data-scroll-target="#selecting-blocks"><span class="header-section-number">4.1.1</span> Selecting Blocks</a></li>
  <li><a href="#rcbd-model-and-analysis" id="toc-rcbd-model-and-analysis" class="nav-link" data-scroll-target="#rcbd-model-and-analysis"><span class="header-section-number">4.1.2</span> RCBD Model and Analysis</a></li>
  </ul></li>
  <li><a href="#did-blocking-work" id="toc-did-blocking-work" class="nav-link" data-scroll-target="#did-blocking-work"><span class="header-section-number">4.2</span> Did Blocking Work?</a></li>
  <li><a href="#blocking-and-power" id="toc-blocking-and-power" class="nav-link" data-scroll-target="#blocking-and-power"><span class="header-section-number">4.3</span> Blocking and Power</a></li>
  <li><a href="#row-column-designs" id="toc-row-column-designs" class="nav-link" data-scroll-target="#row-column-designs"><span class="header-section-number">4.4</span> Row-Column Designs</a></li>
  <li><a href="#incomplete-block-designs" id="toc-incomplete-block-designs" class="nav-link" data-scroll-target="#incomplete-block-designs"><span class="header-section-number">4.5</span> Incomplete Block Designs</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Block Designs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>At this point in the course, we make a distinct change of focus. Up to now, weâ€™ve concentrated on analyzing data coming from various <strong>treatment</strong> designs. Weâ€™ve considered multiple flavors of one-way designs (unstructured, control vs others, regression, other structure) and factorials (2 factors, 3 factors, could have more than 3). In all cases though, weâ€™ve been using the same <strong>experimental</strong> design: the completely randomized design (CRD). Now, we change our focus to other experimental designs. The treatment designs will be those weâ€™ve seen before, and weâ€™ll continue to analyze treatment effects using methods weâ€™ve already discussed.</p>
<p>With a shift to experimental designs, weâ€™ll be considering</p>
<p><br>
<br>
<br>
</p>
<p>This also means</p>
<p><br>
<br>
</p>
<p>Weâ€™re going to start with the simplest experimental design (besides the CRD): the <strong>randomized complete block design</strong> (RCBD) and then move on to other block designs.</p>
<p>Consider an experiment in which we are interested in comparing six different lab activities for teaching the central limit theorem. Based on a power analysis, we believe four replications per treatment is sufficient, and so we need a total of 24 lab teams. Weâ€™ve got two options:</p>
<ul>
<li><br>
</li>
<li></li>
</ul>
<p>Which do you pick? Why? What are pros and cons of each?</p>
<p><br>
<br>
<br>
<br>
</p>
<p>Suppose you decide to use teams in different classes (or you donâ€™t have a choice). How will you assign treatments to teams?</p>
<p><br>
<br>
<br>
</p>
<p>Suppose we allocate treatments to teams completely at random (CRD), and by chance four out of six teams in one class are assigned to treatment 1. Would you be okay with this?</p>
<p><br>
<br>
<br>
</p>
<p>One of the main problems with the CRD is a possible â€˜conditionalâ€™ bias. That is, treatment assignment is not balanced relative to any systematic variation/gradient. In this experiment, the gradient is</p>
<p><br>
<br>
<br>
</p>
<p>When this happens, treatment effect is confounded with gradient. Is any effect we observe really due to treatment, or is it due to the effect of the class? The other problem with the CRD is variance inflation. Suppose there is a gradient among the experimental units, with response increasing as you go up a gradient:</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Even if all the same treatment is applied throughout, the variance among the experimental units (the residuals) will be composed of two quantities:</p>
<p><br>
</p>
<p>This means it will appear larger than it actually is. The most common solution to these problems of confounding and variance inflation is <strong>blocking</strong>.</p>
<p>The idea of blocking is:</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>Blocking allows us to reconcile two somewhat opposing aims of experimental design.</p>
<ul>
<li><br>
</li>
<li><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</li>
</ul>
<p>In summary, the general idea of blocking is to organize experimental units into groups that are as uniform as possible. We want to</p>
<p><br>
<br>
<br>
</p>
<p>Blocks usually represent naturally occurring differences not related to treatments. If we block â€˜correctlyâ€™ then the design accounts for block variation, and allows us to pull it out and isolate the usual random error due to experimental units. If we block â€˜incorrectlyâ€™ then we get a weaker experiment.</p>
<p><strong>How Do We Block?</strong></p>
<p>There are two basic steps in blocking an experiment:</p>
<ol type="1">
<li><p>Organize the experimental units into subsets (blocks) according to gradient</p></li>
<li><p>Restrict the randomization so that each treatment is assigned to one or fewer (zero) experimental units in each block.</p></li>
</ol>
<section id="the-randomized-complete-block-design" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="the-randomized-complete-block-design"><span class="header-section-number">4.1</span> The Randomized Complete Block Design</h2>
<p>The simplest block design is the <strong>randomized complete block design</strong> (RCBD). In this design</p>
<p><br>
<br>
<br>
<br>
</p>
<p>In the RCBD, we carry out the two steps referenced on the previous page as</p>
<ol type="1">
<li><p>Divide the experimental units into blocks of homogeneous units.</p></li>
<li><p>Randomly assign treatments to units within blocks, using a separate randomization for each block. Every treatment will appear in every block.</p></li>
</ol>
<p>Again, we carry out step 1 with the goal</p>
<p><br>
<br>
<br>
</p>
<p>The model for the RCBD helps point out some considerations for choosing blocks. The model (assuming a one-way treatment design) is:</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>The ANOVA table looks like</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p><strong>Example:</strong> An experiment was carried out to evaluate the effect of elevated CO<span class="math inline">\(_2\)</span> on rice grain yield. Four blocks of 2 rice paddies each (each block owned by a different farmer, who used different fertilizer regimes and management practices over the years) are available for the experiment. In each paddy there is a 12 m diameter circular plot. In one plot in each block there is a ring of tubing around the plot emitting CO<span class="math inline">\(_2\)</span> at a rate of 300 ppm above ambient level. In the other plot, no CO<span class="math inline">\(_2\)</span> is emitted. The grain yield is measured at 3 locations in each plot at the end of the season, and the response is the average of the 3 locations.</p>
<p>What is the experimental unit here?</p>
<p>What does the assumption of no block <span class="math inline">\(\times\)</span> treatment interaction mean in this example?</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We can check it with an interaction plot. Here are the means for each plot</p>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Block</th>
<th style="text-align: center;">Ambient CO<span class="math inline">\(_2\)</span></th>
<th style="text-align: center;">Elevated CO<span class="math inline">\(_2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">6.21</td>
<td style="text-align: center;">6.41</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">6.25</td>
<td style="text-align: center;">6.42</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">6.10</td>
<td style="text-align: center;">6.26</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">6.14</td>
<td style="text-align: center;">6.30</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="block.jpeg" class="img-fluid figure-img" style="width:70.0%" alt="The graph shows the interaction plot for treatment x block with the rice data. The lines are roughly parallel, indicating that there is no interaction"></p>
<figcaption>Interaction plot for treatment x block.</figcaption>
</figure>
</div>
<p>If you had been presented with this data in STAT 102 (or STAT 318), how would you have analyzed it?</p>
<p><br>
<br>
</p>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Block</th>
<th style="text-align: center;">Ambient CO<span class="math inline">\(_2\)</span></th>
<th style="text-align: center;">Elevated CO<span class="math inline">\(_2\)</span></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">6.21</td>
<td style="text-align: center;">6.41</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">6.25</td>
<td style="text-align: center;">6.42</td>
<td></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: center;">6.10</td>
<td style="text-align: center;">6.26</td>
<td></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: center;">6.14</td>
<td style="text-align: center;">6.30</td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p><br>
<br>
<br>
<br>
</p>
<section id="selecting-blocks" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="selecting-blocks"><span class="header-section-number">4.1.1</span> Selecting Blocks</h3>
<p>Remember that the RCBD is an <strong>experimental</strong> design, not a treatment design. It can be used with any treatment design. So, we might see RCBD layouts that look like:</p>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Block 1</th>
<th style="text-align: center;">Block 2</th>
<th style="text-align: center;">Block 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Control</td>
<td style="text-align: center;">Trt2</td>
<td style="text-align: center;">Trt4</td>
</tr>
<tr class="even">
<td style="text-align: center;">Trt2</td>
<td style="text-align: center;">Control</td>
<td style="text-align: center;">Trt3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Trt3</td>
<td style="text-align: center;">Trt4</td>
<td style="text-align: center;">Trt2</td>
</tr>
<tr class="even">
<td style="text-align: center;">Trt4</td>
<td style="text-align: center;">Trt3</td>
<td style="text-align: center;">Control</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Block 1</th>
<th style="text-align: center;">Block 2</th>
<th style="text-align: center;">Block 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">20</td>
<td style="text-align: center;">60</td>
<td style="text-align: center;">80</td>
</tr>
<tr class="even">
<td style="text-align: center;">60</td>
<td style="text-align: center;">40</td>
<td style="text-align: center;">20</td>
</tr>
<tr class="odd">
<td style="text-align: center;">80</td>
<td style="text-align: center;">80</td>
<td style="text-align: center;">40</td>
</tr>
<tr class="even">
<td style="text-align: center;">40</td>
<td style="text-align: center;">20</td>
<td style="text-align: center;">60</td>
</tr>
</tbody>
</table>
</div>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Block 1</th>
<th style="text-align: center;">Block 2</th>
<th style="text-align: center;">Block 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">A1 &amp; B1</td>
<td style="text-align: center;">A1 &amp; B1</td>
<td style="text-align: center;">A2 &amp; B2</td>
</tr>
<tr class="even">
<td style="text-align: center;">A2 &amp; B1</td>
<td style="text-align: center;">A2 &amp; B1</td>
<td style="text-align: center;">A1 &amp; B1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">A2 &amp; B2</td>
<td style="text-align: center;">A1 &amp; B2</td>
<td style="text-align: center;">A1 &amp; B2</td>
</tr>
<tr class="even">
<td style="text-align: center;">A1 &amp; B2</td>
<td style="text-align: center;">A2 &amp; B2</td>
<td style="text-align: center;">A2 &amp; B2</td>
</tr>
</tbody>
</table>
</div>
<p>When you write a report, both the treatment design and the experimental design need to be described in the methods section.</p>
<p><strong>Tips for Choosing Blocks:</strong></p>
<ul>
<li>We want to maximize differences between blocks and minimize differences within blocks</li>
</ul>
<p><br>
<br>
<br>
<br>
<br>
</p>
<ul>
<li>Block size should not be excessively large</li>
</ul>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<ul>
<li>Keep in the mind the no block <span class="math inline">\(\times\)</span> treatment interaction assumption</li>
</ul>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p><strong>Common Criteria for Blocking:</strong></p>
<ul>
<li><p>gradients that occur in the field, in greenhouses, in growth chambers</p></li>
<li><p>weight groups in animal experimentation, litters, cage positions in a room</p></li>
<li><p>occasion (day, month, year)</p></li>
<li><p>location (barn, different fields, different rooms, different states)</p></li>
<li><p>subjects (each subject serves as their own control)</p></li>
</ul>
</section>
<section id="rcbd-model-and-analysis" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="rcbd-model-and-analysis"><span class="header-section-number">4.1.2</span> RCBD Model and Analysis</h3>
<p>Let <span class="math inline">\(y_{ij}\)</span> be</p>
<p><br>
<br>
<br>
</p>
<p>Earlier we stated the model</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We do have another choice to make. We can consider the block effect to either be a <strong>fixed effect</strong> or a <strong>random effect</strong>.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Our choice will have implications in the ANOVA table (in the Expected Mean Squares) and in the standard errors of the cell means.</p>
<p><br>
<br>
<br>
</p>
<p>To estimate the difference between two treatment means <span class="math inline">\((\mu_{i\cdot} - \mu_{i'\cdot})\)</span>, we use <span class="math inline">\(\overline y_{i\cdot} - \overline y_{i'\cdot}\)</span>. To figure out the variance (or estimate of the variance), letâ€™s look at what <span class="math inline">\(\overline y_{i\cdot}\)</span> is actually estimating:</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Now letâ€™s explore the variance of this quantity.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Now letâ€™s consider <span class="math inline">\(\overline y_{i\cdot} - \overline y_{i'\cdot}\)</span>:</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>and its variance</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>If we want to construct confidence intervals for treatment means or differences, theyâ€™ll have the form</p>
<p><br>
<br>
</p>
<p>where the standard error is</p>
<p>For example, we use MSE as our estimate of <span class="math inline">\(\sigma^2\)</span>, so confidence intervals for the difference between two means is</p>
<p><br>
<br>
<br>
<br>
</p>
<p><strong>RCBDs in SAS</strong></p>
<p>We can still use <code>PROC GLIMMIX</code> to fit the model if our experimental design is the RCBD. The basic program for <strong>fixed blocks</strong> is</p>
<pre><code>    proc glimmix data=dataset;
      class block trt;
      model y = block trt;
    run;</code></pre>
<p>Note:</p>
<p><br>
<br>
</p>
<p>The basic program for <strong>random blocks</strong> is</p>
<pre><code>    proc glimmix data=dataset;
      class block trt;
      model y = trt;
      random block;
    run;</code></pre>
<p>Note:</p>
<p><br>
<br>
</p>
<p><strong>Example:</strong> This experiment is looking at the emergence rate of soybean seeds treated with four different chemical treatments and a control.</p>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;">Treatment Number</th>
<th style="text-align: left;">Treatment Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;">Control</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;">Arasan</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: left;">Spergon</td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: left;">Semesan</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: left;">Fermate</td>
</tr>
</tbody>
</table>
</div>
<p><strong>Experimental Layout:</strong> The field is located on a slope, and blocks are formed based on elevation. There are five plots at each elevation, and five blocks.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p><strong>Treatment Design:</strong></p>
<p><br>
<br>
<br>
</p>
<p>100 seeds were planted in each plot, and the response is the number of plants that emerge out of the 100.</p>
<p><br>
<br>
</p>
<p><strong>Model:</strong></p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p><strong>Analysis with Blocks Fixed:</strong></p>
<p>If we assume blocks are fixed, we use the code</p>
<pre><code>proc glimmix data=seeds;
  class block chem;
  model emerge=block chem;
run;</code></pre>
<p>which gives</p>
<pre><code>                 Fit Statistics
    
    Pearson Chi-Square / DF         5.41
    
         Type III Tests of Fixed Effects
                  Num      Den
    Effect         DF       DF    F Value    Pr &gt; F
    
    block           4       16       2.30    0.1032
    chem            4       16       3.87    0.0219
    </code></pre>
<p>The follow-up analyses donâ€™t change from what weâ€™ve done so far. In this case, the treatment design is one-way treatment-versus-control, so comparing all treatments to the control is appropriate and we can use the Dunnett adjustment.</p>
<pre><code>    lsmeans chem/diff=control('Control') adjust=dunnett;

                        Chem Least Squares Means
    
                           Standard
    Chem       Estimate       Error       DF    t Value    Pr &gt; |t|
    
    Arasan      93.8000      1.0402       16      90.18      &lt;.0001
    Control     89.2000      1.0402       16      85.75      &lt;.0001
    Fermate     94.2000      1.0402       16      90.56      &lt;.0001
    Semesan     93.4000      1.0402       16      89.79      &lt;.0001
    Spergon     91.8000      1.0402       16      88.25      &lt;.0001</code></pre>
<pre><code>                Differences of Chem Least Squares Means
              Adjustment for Multiple Comparisons: Dunnett
    
                                      Standard
    Chem       _Chem      Estimate       Error       DF    t Value    Pr &gt; |t|     Adj P
    
    Arasan     Control      4.6000      1.4711       16       3.13      0.0065    0.0218
    Fermate    Control      5.0000      1.4711       16       3.40      0.0037    0.0125
    Semesan    Control      4.2000      1.4711       16       2.86      0.0115    0.0375
    Spergon    Control      2.6000      1.4711       16       1.77      0.0962    0.2680
    </code></pre>
<p><strong>Analysis with Blocks Random:</strong></p>
<p>If we assume blocks are random, we use the code</p>
<pre><code>    proc glimmix data=seeds;
      class block chem;
      model emerge=chem;
      random block;
      lsmeans chem/diff=control('Control') adjust=dunnett;
    run;</code></pre>
<p>which gives</p>
<pre><code>              Fit Statistics
    Gener. Chi-Square / DF          5.41
    
      Covariance Parameter Estimates
                            Standard
    Cov Parm    Estimate       Error
    block         1.4100      1.8032
    Residual      5.4100      1.9127
    
           Type III Tests of Fixed Effects
                  Num      Den
    Effect         DF       DF    F Value    Pr &gt; F
    Chem            4       16       3.87    0.0219
    
                    Chem Least Squares Means
                           Standard
    Chem       Estimate       Error       DF    t Value    Pr &gt; |t| 
    Arasan      93.8000      1.1679       16      80.31      &lt;.0001
    Control     89.2000      1.1679       16      76.38      &lt;.0001
    Fermate     94.2000      1.1679       16      80.66      &lt;.0001
    Semesan     93.4000      1.1679       16      79.97      &lt;.0001
    Spergon     91.8000      1.1679       16      78.60      &lt;.0001</code></pre>
<pre><code>                     Differences of Chem Least Squares Means
                Adjustment for Multiple Comparisons: Dunnett-Hsu
                                      Standard
    Chem       _Chem      Estimate       Error       DF    t Value    Pr &gt; |t|     Adj P    
    Arasan     Control      4.6000      1.4711       16       3.13      0.0065    0.0218
    Fermate    Control      5.0000      1.4711       16       3.40      0.0037    0.0125
    Semesan    Control      4.2000      1.4711       16       2.86      0.0115    0.0375
    Spergon    Control      2.6000      1.4711       16       1.77      0.0962    0.2680
    </code></pre>
<p>The results are the same whether we used fixed blocks or random blocks. This is because our data are <strong>balanced</strong>â€“we had the same number of observations in each block, and all treatments appear in all blocks. If our data had not been balanced, the results would be different.</p>
<p>Letâ€™s go back to the ANOVA table to see where the estimate of <span class="math inline">\(\sigma^2_R\)</span> is coming from</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We just said that the analysis based on the treatment design will not change. Letâ€™s consider an example with a one-way regression/quantitative factor levels treatment design.</p>
<p><strong>Example:</strong> In this experiment, seven soil samples were taken from the Canary Islands. Each soil sample was split into five subsamples and a phosphate (Na<span class="math inline">\(_2\)</span>,PO<span class="math inline">\(_4\)</span>H) was added in amounts 0, 50, 100, 150, 200 ppm to these five subsamples (note even spacing). At the end of the experiment, the amount of exchangeable calcium was measured on each subsample. The seven samples serve as blocks. There are five levels of phosphate so</p>
<p><br>
</p>
<p>Letâ€™s first consider blocks fixed (it doesnâ€™t matter here, since the experiment is balanced). First we have to decide the order of the polynomial:</p>
<pre><code>    proc glimmix data=soil;
      class block;
      model calcium=block phos phos*phos phos*phos*phos phos*phos*phos*phos/htype=1;
    run;</code></pre>
<p>which gives output:</p>
<pre><code>                 Fit Statistics
    Pearson Chi-Square / DF         0.13
    
                 Type I Tests of Fixed Effects
                            Num      Den
    Effect                   DF       DF    F Value    Pr &gt; F
    
    block                     6       24     109.80    &lt;.0001
    phos                      1       24       7.08    0.0137
    phos*phos                 1       24       1.62    0.2147
    phos*phos*phos            1       24       1.88    0.1829
    phos*phos*phos*phos       1       24       0.48    0.4940
    </code></pre>
<p><br>
<br>
</p>
<p>Now that weâ€™ve determined the appropriate polynomial, we can get the fitted model:</p>
<pre><code>    proc glimmix data=soil;
      class block;
      model calcium=block phos/htype=1 solution;
    run;</code></pre>
<p>which gives</p>
<pre><code>                               Parameter Estimates
                                      Standard
    Effect       block    Estimate       Error       DF    t Value    Pr &gt; |t|
    
    Intercept               1.9737      0.1854       27      10.65      &lt;.0001
    block        1          1.4520      0.2312       27       6.28      &lt;.0001
    block        2          2.2280      0.2312       27       9.64      &lt;.0001
    block        3          0.8540      0.2312       27       3.69      0.0010
    block        4          0.4420      0.2312       27       1.91      0.0666
    block        5          5.0280      0.2312       27      21.75      &lt;.0001
    block        6          0.9960      0.2312       27       4.31      0.0002
    block        7               0           .        .        .         .
    phos                  0.002283    0.000874       27       2.61      0.0145
    Scale                   0.1336     0.03637        .        .         .
    </code></pre>
<p>So the fitted model is:</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>Do we really care about the effect Block 1 has on exchangeable calcium? Probably not. The seven soil samples were likely selected at random, so it really makes sense to treat blocks as random. Letâ€™s go back to the most complicated possible model and start over.</p>
<pre><code>    proc glimmix data=soil;
      class block;
      model calcium=phos phos*phos phos*phos*phos phos*phos*phos*phos/htype=1;
      random block;
    run;

      Covariance Parameter Estimates
                            Standard
    Cov Parm    Estimate       Error
    
    block         2.8049      1.6343
    Residual      0.1289     0.03721</code></pre>
<pre><code>    
                 Type I Tests of Fixed Effects
                            Num      Den
    Effect                   DF       DF    F Value    Pr &gt; F
    
    phos                      1       24       7.08    0.0137
    phos*phos                 1       24       1.62    0.2147
    phos*phos*phos            1       24       1.88    0.1829
    phos*phos*phos*phos       1       24       0.48    0.4940
    </code></pre>
<p><br>
<br>
</p>
<p>Now letâ€™s get the final model</p>
<pre><code>    proc glimmix data=soil;
      class block;
      model calcium=phos/htype=1 solution;
      random block;
    run;

     Covariance Parameter Estimates
                            Standard
    Cov Parm    Estimate       Error
    
    block         2.8040      1.6343
    Residual      0.1336     0.03637
    
                      Solutions for Fixed Effects
                             Standard
    Effect       Estimate       Error       DF    t Value    Pr &gt; |t|
    
    Intercept      3.5451      0.6419        6       5.52      0.0015
    phos         0.002283    0.000874       27       2.61      0.0145
    
            Type I Tests of Fixed Effects
                  Num      Den
    Effect         DF       DF    F Value    Pr &gt; F
    
    phos            1       27       6.83    0.0145
    </code></pre>
<p>So, our fitted model is</p>
<p><br>
<br>
</p>
<p>Note that when we treated blocks as either fixed or random</p>
<ul>
<li><p>We ended up picking the same model</p></li>
<li><p>The estimate for the slope was the same</p></li>
</ul>
<p>Our goal was to describe the relationship between the treatment and the response. The blocks just give us a way to eliminate excess variance.</p>
</section>
</section>
<section id="did-blocking-work" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="did-blocking-work"><span class="header-section-number">4.2</span> Did Blocking Work?</h2>
<p>When we treated blocks as fixed effects, we get a p-value associated with block but it is completely meaningless because there is no valid hypothesis test for evaluating the effect of block. However, we can check the <strong>efficiency</strong> of the block design relative to a competing design.</p>
<p>Suppose we have <span class="math inline">\(t\)</span> treatments and <span class="math inline">\(rt\)</span> experimental units available for our experiment. We have two possible experimental designs:</p>
<ul>
<li><br>
</li>
<li></li>
</ul>
<p>The only difference between these is whether we group the experimental units into blocks before randomly assigning the treatments. Efficiency gives us a way to compare the variance of two competing designsâ€“we want to select the design that gives us the smaller variance of estimated treatment differences.</p>
<ul>
<li><p>CRD:<br>
<br>
<br>
</p></li>
<li><p>RCBD<br>
<br>
<br>
</p></li>
</ul>
<p>So the choice between these two designs comes down to a comparison of <span class="math inline">\(\sigma^2_{CRD}\)</span> and <span class="math inline">\(\sigma^2_{RCBD}\)</span>. We can compare variances using a ratio called the <strong>relative efficiency</strong>.</p>
<p><br>
</p>
<p>If RE <span class="math inline">\(&gt;\)</span> 1</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Once weâ€™ve conducted an RCBD experiment we can look and see whether we did the right thing when we used blocks.</p>
<p><br>
<br>
<br>
<br>
</p>
<p>Note there is a difference in the error degrees of freedom between the CRD and RCBD which can have an impact. We can adjust for this difference by calculating the <strong>adjusted relative efficiency</strong>:</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>The correction factor is always less than 1, and usually wonâ€™t make much difference. It can make a difference if the number of treatments and reps is small.</p>
<p><strong>Example: Rice paddies</strong> In this example, there were 4 blocks and two treatments. Weâ€™ll fit the model both with blocks and without.</p>
<ul>
<li>RCBD:</li>
</ul>
<p><br>
</p>
<ul>
<li>CRD:</li>
</ul>
<p><br>
</p>
<p><strong>Example: Seed Emergence</strong> In this example, there were five blocks and five treatments. Again, weâ€™ll fit the model both with blocks and without.</p>
<ul>
<li><p>RCBD:<br>
</p></li>
<li><p>CRD:<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p></li>
</ul>
</section>
<section id="blocking-and-power" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="blocking-and-power"><span class="header-section-number">4.3</span> Blocking and Power</h2>
<p>Weâ€™ve used several methods to determine power and sample size for CRDs: <code>proc power</code>, <code>proc glmpower</code>, and tricking <code>proc glimmix</code> into calculating it for us. We can use the third option to incorporate blocking into our power calculations. These often require a pilot data set so we can get some idea about how much variance we expect among the blocks.</p>
<p><strong>Example:</strong> Researchers are interested in exploring the effect of three types of insecticide on the count of plant seedlings. They know there will be variability due to location in the greenhouse, so they plan on using an RCBD. They have pilot data from a previous study in the greenhouse, with 4 samples from 6 greenhouse benches selected at random. The data are in â€˜block power.sas.â€™</p>
<p>The researchers want to treat block as random, so we need estimates of both <span class="math inline">\(\sigma^2\)</span> and <span class="math inline">\(\sigma^2_R\)</span>. We can get estimates of both of these based on our pilot data, as well as 75% confidence intervals for the variances.</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>We can use the following code:</p>
<pre><code>    proc glimmix noprofile data=seedlings;
      class plot;
      model count = ;
      random plot;
      covtest / cl(type=plr alpha=0.25);
    run;</code></pre>
<pre><code>                              Covariance Parameter Estimates
                                           Profile Likelihood 75% Confidence Bounds
                                        ------- Lower ------    ------- Upper ------
                            Standard                    Pr &gt;                    Pr &gt;
    Cov Parm    Estimate       Error       Bound       Chisq       Bound       Chisq
    
    plot         44.5903     29.1831     22.5497      0.2500      104.00      0.2500
    Residual      6.1806      2.0602      4.3102      0.2500      9.3093      0.2500
    </code></pre>
<p>Now weâ€™ve got estimates for the variances, and can turn our attention to the differences we want to be able to detect. The researchers are interested in detecting differences of 1, 2, and 3 units. Weâ€™re going to start with 6 blocks, and see if thatâ€™s enough power. They want <span class="math inline">\(\alpha=0.05\)</span> and are aiming for a power of 0.80.</p>
<p>We can modify the previous code we used to trick <code>glimmix</code> as follows:</p>
<pre><code>    *set up example data set with initial parameters;
    data seedlingsa;
      nblock=6;
      input insecticide mu;
      do block=1 to nblock;
        output;
      end;
    datalines;
    1 79
    2 82
    3 80
    ;
    
    proc glimmix data=seedlingsa;
      class block insecticide;
      model mu=insecticide;
      random block;
      parms(104)(9.3093)/hold=1,2;
      contrast '1 unit diff' insecticide 1 0 -1;
      contrast '2 unit diff' insecticide 0 1 -1;
      contrast '3 unit diff' insecticide 1 -1 0;
      lsmeans  insecticide/diff cl;
      ods output tests3=overallF1 contrasts=contrastF1;
    run;
    </code></pre>
<pre><code>    /* Power computation &amp; Print step */
    data power1;
      set overallF1 contrastF1;
      alpha=0.05;
      ncparm=numDF*Fvalue;
      Critical_F=Finv(1-alpha,numDF,denDF,0);
      Power=1-probF(Critical_F,numDF,denDF,ncparm);
    
    proc print data=power1;
      var effect label numdf dendf alpha critical_F ncparm Power; 
      title 'power - RCBD';
    run;
    </code></pre>
<p>which gives the following:</p>
<pre><code>                                             power - RCBD        
                              Num                      Critical_
    Obs      Effect          Label         DF    DenDF    alpha        F         ncparm     Power
    1     insecticide                      2       10     0.05     4.10282     3.00774    0.24820
    2                    1 unit diff       1       10     0.05     4.96460     0.32226    0.08092
    3                    2 unit diff       1       10     0.05     4.96460     1.28903    0.17731
    4                    3 unit diff       1       10     0.05     4.96460     2.90033    0.33778
    </code></pre>
<p>So it doesnâ€™t look like 6 blocks is enough. Even with a 3 unit difference, the power is only 0.33778. Letâ€™s see what happens if we increase the block size to</p>
<ul>
<li>20 blocks:</li>
</ul>
<p><br>
<br>
<br>
</p>
<ul>
<li>40 blocks:</li>
</ul>
<p><br>
<br>
<br>
</p>
<ul>
<li>150 blocks:</li>
</ul>
<p><br>
<br>
</p>
</section>
<section id="row-column-designs" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="row-column-designs"><span class="header-section-number">4.4</span> Row-Column Designs</h2>
<p>Sometimes there are two blocking variables that can be used to reduce extraneous variability, rather than one factor. If it possible to block on both of the variables we may be able to increase precision while using the same number of experimental units as in a randomized complete block design.</p>
<p>Designs with two blocking criteria are called <strong>row-column designs</strong>. There are several different types of row-column designs,and weâ€™ll discuss one of them, specifically the Latin square.</p>
<p><br>
</p>
<p>Row-column designs tend to be situations in which there are two gradients:</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>The generic model for row-column designs is</p>
<pre><code>            observation = row + column + treatment + error</code></pre>
<p>We assume there is no row<span class="math inline">\(\times\)</span>column interaction, no row<span class="math inline">\(\times\)</span>treatment interaction, and no column<span class="math inline">\(\times\)</span>treatment interaction.</p>
<p><strong>Example:</strong> Suppose we want to compare five kinds of glue, and glue is affected by temperature and humidity. Temperature and humidity vary across days and over time throughout the day, so two possible blocking criteria are day and hour. A <strong>Latin Square</strong> for five treatments blocks on day and hour looks like this</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Each day has a full set of five treatments and each hour has a full set of five treatments, so both day and hour could be considered blocks. The two types of blocking are superimposed on each other.</p>
<p>The Latin Square design requires</p>
<p><br>
<br>
<br>
</p>
<p>By using a Latin square arrangement, we are able to control for 5 rows <span class="math inline">\(\times\)</span> 5 columns <span class="math inline">\(\times\)</span> 5 treatments = 125 combinations using only 25 experimental units. Because of this feature, Latin squares have the potential for large gains in efficiency without using more experimental material.</p>
<p>The model for a Latin square is</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>Just like with RCBDs we can consider rows and columns to be either fixed or random. The corresponding ANOVA table is</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p><strong>Example:</strong> Consider an experiment to study yield of four wheat varieties (A, B, C, D). There are gradients running parallel to both sides of the field</p>
<p><br>
<br>
<br>
<br>
</p>
<p>To account for both gradients, the experiment was conducted as a 4 <span class="math inline">\(\times\)</span> 4 Latin square. Yields are in kg per plot. The plot layout with the data:</p>
<div class="center">
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td style="text-align: center;">Column</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Row</td>
<td>1</td>
<td style="text-align: center;">2</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td>1</td>
<td>10.5 (C)</td>
<td style="text-align: center;">7.7 (D)</td>
<td>12.0 (B)</td>
<td>13.2 (A)</td>
</tr>
<tr class="even">
<td>2</td>
<td>11.1 (B)</td>
<td style="text-align: center;">12.0 (A)</td>
<td>10.3 (C)</td>
<td>7.5 (D)</td>
</tr>
<tr class="odd">
<td>3</td>
<td>5.8 (D)</td>
<td style="text-align: center;">12.2 (C)</td>
<td>11.2 (A)</td>
<td>13.7 (B)</td>
</tr>
<tr class="even">
<td>4</td>
<td>11.6 (A)</td>
<td style="text-align: center;">12.3 (B)</td>
<td>5.9 (D)</td>
<td>10.2 (C)</td>
</tr>
</tbody>
</table>
</div>
<p>In this example, the model is</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>and ANOVA table</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>The analysis in SAS is very similar to the RCBD:</p>
<pre><code>  proc glimmix data=wheat;
    class row col variety;
    model yield=variety;
    random row col;
  run;</code></pre>
<p>In this example, we are considering rows and columns as random effects. The output is:</p>
<pre><code>
          Covariance Parameter Estimates
                                Standard
        Cov Parm    Estimate       Error
        
        row          0.04958      0.1482
        col           0.4533      0.4673
        Residual      0.4533      0.2617
        
               Type III Tests of Fixed Effects
                      Num      Den
        Effect         DF       DF    F Value    Pr &gt; F
        
        variety         3        6      58.03    &lt;.0001</code></pre>
<p>It looks like there is a difference among the four varieties. We could follow up with whatever treatment design analysis is most appropriate (LSD, Tukey, maybe contrasts) just as before. A Latin square is a experimental design and like the RCBD can be paired with any treatment design.</p>
<p>The downside to the Latin square is that it can be restrictive, since # treatments = # columns = # rows. This means</p>
<ul>
<li></li>
</ul>
<p><br>
<br>
</p>
<ul>
<li></li>
</ul>
<p><br>
<br>
</p>
<p>The randomization of Latin squares is quite involved, and details will be left to a more advanced design course. There are other row-column designs as well which offer more flexibility than the Latin square. These include Latin rectangles and replicated Latin squares. Weâ€™ll also leave those to a second design course.</p>
</section>
<section id="incomplete-block-designs" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="incomplete-block-designs"><span class="header-section-number">4.5</span> Incomplete Block Designs</h2>
<p>When we discussed RCBDs, we noted that we needed enough experimental units in each block to accommodate all treatments. However, in some situations, the number of treatments exceeds block size. This can happen because of the physical size of the block or shortages of experimental equipment or facilities. In instances like this, we can use randomized block designs in which every treatment is not present in every block. These designs are called <strong>incomplete block designs</strong>.</p>
<p><strong>Example:</strong> A baker is testing different cookie recipes, and has 9 recipes to test. Due to oven size and baking time available, the baker can only test 6 recipes per day. However, they know itâ€™s important to block on day since oven temperature can vary day to to day. The RCDB would say use blocks of 1.5 days, and ignore the fact that days might not be homogeneous within a block. A better way is to use incomplete blocks of size six (one day). Consider the following set up:</p>
<div class="center">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: right;"></th>
<th style="text-align: center;">Treatments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Day 1</td>
<td style="text-align: center;">4, 5, 6, 7, 8, 9</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: center;">2, 3, 5, 6, 8, 9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: center;">2, 3, 4, 6, 7, 8</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: center;">2, 3, 4, 5, 7, 9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: center;">1, 3, 5, 6, 7, 8</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: center;">1, 3, 4, 6, 7, 9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: center;">1, 3, 4, 5, 8, 9</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: center;">1, 2, 5, 6, 8, 9</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: center;">1, 2, 4, 6, 8, 9</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: center;">1, 2, 4, 5, 7, 8</td>
</tr>
<tr class="odd">
<td style="text-align: right;">11</td>
<td style="text-align: center;">1, 2, 3, 7, 8, 9</td>
</tr>
<tr class="even">
<td style="text-align: right;">12</td>
<td style="text-align: center;">1, 2, 3, 4, 5, 6</td>
</tr>
</tbody>
</table>
</div>
<p>This design is a <strong>balanced incomplete block</strong> (BIB) design. Itâ€™s balanced because</p>
<p><br>
<br>
<br>
</p>
<p>Standard notation for incomplete blocks is</p>
<ul>
<li><br>
</li>
<li><br>
</li>
<li><br>
</li>
<li><br>
</li>
<li></li>
</ul>
<p>These values are not independent, but must satisfy three conditions:</p>
<ol type="1">
<li><br>
</li>
<li><br>
<br>
</li>
<li><br>
</li>
</ol>
<p>Additionally,</p>
<p><br>
<br>
</p>
<p>BIBs do not exist for all combinations of blocks sizes, number of treatments, and number of replications. For example, with the cookie scenario, there is no BIB design with few than 8 replications. These restrictions means BIBs are not always feasible. However, when they are an option, they can very useful.</p>
<p><strong>Example:</strong> Suppose we have <span class="math inline">\(t=6\)</span> treatments and block size that can accommodate <span class="math inline">\(k=4\)</span> observations per block.</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>So if BIBs are not always feasible, why are they still useful? BIB designs are <strong>optimal</strong> in that</p>
<p><br>
<br>
<br>
</p>
<p>If you are willing to give up balance, we can find a design with far fewer replicates that is nearly balanced and nearly as efficient as a BIB would be if it existed. <strong>Partially balanced incomplete block</strong> (PBIB) designs share many features with BIBs. In PBIBs</p>
<p><br>
<br>
</p>
<p>Not all incomplete block designs qualify as partially balanced. A PBIB must satisfy three criteria:</p>
<ol type="1">
<li><br>
</li>
<li><br>
</li>
<li><br>
<br>
</li>
</ol>
<p>Consider the following set-up:</p>
<div class="left">
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Block</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>1</strong></td>
<td style="text-align: center;"><strong>2</strong></td>
<td style="text-align: center;"><strong>3</strong></td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: center;">3</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">5</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">4</td>
</tr>
</tbody>
</table>
</div>
<p><br>
</p>
<p>The analysis of incomplete block designs is just like the analysis for an RCBD with missing data. We didnâ€™t discuss the implications of missing data on the RCBD, but missing data means that we donâ€™t get the same results for random and fixed blocks and we have to carefully think about which choice is most appropriate. Missing data also means that cell (arithmetic) means wonâ€™t be the same as <code>lsmeans</code>, and we should be sure to look at <code>lsmeans</code>.</p>
<p><strong>Example:</strong> An experiment was designed to test the wearing quality of <span class="math inline">\(t=7\)</span> types of cloth. The machine used to test the wearing quality can only process four pieces of cloth at the same time. Machine run is considered the block. Hereâ€™s a layout of the design</p>
<div class="center">
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td style="text-align: center;"></td>
<td></td>
<td><strong>Cloth</strong></td>
<td><strong>Type</strong></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><strong>Block</strong></td>
<td style="text-align: center;">A</td>
<td>B</td>
<td>C</td>
<td>D</td>
<td>E</td>
<td>F</td>
<td>G</td>
</tr>
<tr class="odd">
<td>1</td>
<td style="text-align: center;"></td>
<td>627</td>
<td></td>
<td>248</td>
<td></td>
<td>563</td>
<td>252</td>
</tr>
<tr class="even">
<td>2</td>
<td style="text-align: center;">344</td>
<td></td>
<td>233</td>
<td></td>
<td></td>
<td>442</td>
<td>226</td>
</tr>
<tr class="odd">
<td>3</td>
<td style="text-align: center;"></td>
<td></td>
<td>251</td>
<td>211</td>
<td>160</td>
<td></td>
<td>297</td>
</tr>
<tr class="even">
<td>4</td>
<td style="text-align: center;">337</td>
<td>537</td>
<td></td>
<td></td>
<td>195</td>
<td></td>
<td>300</td>
</tr>
<tr class="odd">
<td>5</td>
<td style="text-align: center;"></td>
<td>520</td>
<td>278</td>
<td></td>
<td>199</td>
<td>595</td>
<td></td>
</tr>
<tr class="even">
<td>6</td>
<td style="text-align: center;">369</td>
<td></td>
<td></td>
<td>196</td>
<td>1985</td>
<td>606</td>
<td></td>
</tr>
<tr class="odd">
<td>7</td>
<td style="text-align: center;">396</td>
<td>602</td>
<td>240</td>
<td>273</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>Letâ€™s check that this is a BIB design.</p>
<p>The data are in <code>fabric.sas</code>. The model is</p>
<p><br>
<br>
<br>
<br>
<br>
</p>
<p>and the ANOVA table is</p>
<p><br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</p>
<p>We can use the same code we did with RCBDs:</p>
<pre><code>    proc glimmix data=fabric;
      class block type;
      model y=type;
      random block;
      lsmeans type/pdiff adjust=tukey;
    run;</code></pre>
<p>It seems like the 7 machine runs we used could be thought of as a random sample of all runs we could ever do on the machine, so Iâ€™m treating blocks as random. The output is</p>
<pre><code>      Covariance Parameter Estimates
                            Standard
    Cov Parm    Estimate       Error
    
    block         273.40      428.98
    Residual     1471.43      537.29
    
            Type III Tests of Fixed Effects
                  Num      Den
    Effect         DF       DF    F Value    Pr &gt; F
    
    type            6       15      62.73    &lt;.0001</code></pre>
<pre><code>    
                     type Least Squares Means
                        Standard
    type    Estimate       Error       DF    t Value    Pr &gt; |t|
    
    A         363.84     20.6074       15      17.66      &lt;.0001
    B         566.49     20.6074       15      27.49      &lt;.0001
    C         252.61     20.6074       15      12.26      &lt;.0001
    D         227.19     20.6074       15      11.02      &lt;.0001
    E         184.03     20.6074       15       8.93      &lt;.0001
    F         553.22     20.6074       15      26.85      &lt;.0001
    G         273.13     20.6074       15      13.25      &lt;.0001
    
     
                  Differences of type Least Squares Means
              Adjustment for Multiple Comparisons: Tukey-Kramer
                                 Standard
    type    _type    Estimate       Error       DF    t Value    Pr &gt; |t|     Adj P
    
    A       B         -202.65     27.8771       15      -7.27      &lt;.0001    &lt;.0001
    A       C          111.23     27.8771       15       3.99      0.0012    0.0160
    A       D          136.65     27.8771       15       4.90      0.0002    0.0029
    A       E          179.80     27.8771       15       6.45      &lt;.0001    0.0002
    A       F         -189.38     27.8771       15      -6.79      &lt;.0001    &lt;.0001
    A       G         90.7093     27.8771       15       3.25      0.0053    0.0630
    B       C          313.88     27.8771       15      11.26      &lt;.0001    &lt;.0001
    B       D          339.30     27.8771       15      12.17      &lt;.0001    &lt;.0001
    B       E          382.46     27.8771       15      13.72      &lt;.0001    &lt;.0001
    B       F         13.2728     27.8771       15       0.48      0.6408    0.9988
    B       G          293.36     27.8771       15      10.52      &lt;.0001    &lt;.0001
    C       D         25.4242     27.8771       15       0.91      0.3762    0.9648
    C       E         68.5788     27.8771       15       2.46      0.0265    0.2407
    C       F         -300.61     27.8771       15     -10.78      &lt;.0001    &lt;.0001
    C       G        -20.5159     27.8771       15      -0.74      0.4731    0.9878
    D       E         43.1546     27.8771       15       1.55      0.1425    0.7142
    D       F         -326.03     27.8771       15     -11.70      &lt;.0001    &lt;.0001
    D       G        -45.9401     27.8771       15      -1.65      0.1201    0.6566
    E       F         -369.18     27.8771       15     -13.24      &lt;.0001    &lt;.0001
    E       G        -89.0946     27.8771       15      -3.20      0.0060    0.0700
    F       G          280.09     27.8771       15      10.05      &lt;.0001    &lt;.0001
    </code></pre>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Section 3 Factorial Treatment Design.html" class="pagination-link" aria-label="Factorial Treatment Designs">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Factorial Treatment Designs</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Section 5 Split Plot Designs.html" class="pagination-link" aria-label="Split-Plot Designs">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Split-Plot Designs</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>